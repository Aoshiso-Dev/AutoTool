<UserControl x:Class="AutoTool.View.Panels.EditPanelView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:local="clr-namespace:AutoTool.View.Panels"
             xmlns:converters="clr-namespace:AutoTool.View.Converters"
             mc:Ignorable="d">
    <UserControl.Resources>
        <converters:InvertBooleanConverter x:Key="InvertBooleanConverter" />
        <converters:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter" />
        <converters:MultiBoolToVisibilityConverter x:Key="MultiBoolToVisibilityConverter" />
    </UserControl.Resources>
    <!-- Edit Panel Content extracted from MainWindow -->
    <Grid IsEnabled="{Binding IsRunning, Converter={StaticResource InvertBooleanConverter}}" Background="White">
        <Border BorderBrush="LightGray" BorderThickness="1" Margin="5">
            <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled" 
                          Margin="10" Padding="5" Background="White">
                <StackPanel Background="White">
                    <!-- No items message -->
                    <StackPanel Visibility="{Binding IsListEmpty, Converter={StaticResource BoolToVisibilityConverter}}" 
                                Margin="0,20">
                        <TextBlock Text="ãƒªã‚¹ãƒˆã«ã‚³ãƒžãƒ³ãƒ‰ã‚’è¿½åŠ ã—ã¦ãã ã•ã„" 
                                   FontSize="14" Foreground="DarkGray" TextWrapping="Wrap"/>
                        <TextBlock Text="ä¸Šéƒ¨ã®ã€Œè¿½åŠ ã€ãƒœã‚¿ãƒ³ã§ã‚³ãƒžãƒ³ãƒ‰ã‚’è¿½åŠ ã§ãã¾ã™" 
                                   FontSize="11" Foreground="DarkGray" Margin="0,5,0,0" TextWrapping="Wrap"/>
                    </StackPanel>

                    <StackPanel Visibility="{Binding IsListNotEmptyButNoSelection, Converter={StaticResource BoolToVisibilityConverter}}" 
                                Margin="0,20">
                        <TextBlock Text="ãƒªã‚¹ãƒˆã‹ã‚‰ã‚³ãƒžãƒ³ãƒ‰ã‚’é¸æŠžã—ã¦ãã ã•ã„" 
                                   FontSize="14" Foreground="DarkGray" TextWrapping="Wrap"/>
                        <TextBlock Text="é¸æŠžã™ã‚‹ã¨è¨­å®šé …ç›®ãŒè¡¨ç¤ºã•ã‚Œã¾ã™" 
                                   FontSize="11" Foreground="DarkGray" Margin="0,5,0,0" TextWrapping="Wrap"/>
                    </StackPanel>

                    <!-- Settings (shown when item is selected) -->
                    <StackPanel Visibility="{Binding IsNotNullItem, Converter={StaticResource BoolToVisibilityConverter}}">
                        <!-- Command Type Selection -->
                        <StackPanel Orientation="Horizontal" Margin="0,5">
                            <TextBlock Text="ã‚³ãƒžãƒ³ãƒ‰:" Width="120" VerticalAlignment="Center" Foreground="Black"/>
                            <ComboBox ItemsSource="{Binding ItemTypes}" 
                                      SelectedItem="{Binding SelectedItemTypeObj}" 
                                      DisplayMemberPath="DisplayName"
                                      Width="200" Margin="5,0"
                                      Foreground="Black" Background="White"/>
                        </StackPanel>

                        <!-- Window Target Settings -->
                        <StackPanel Margin="0,5" Visibility="{Binding ShowWindowInfo, Converter={StaticResource BoolToVisibilityConverter}}">
                            <StackPanel Orientation="Horizontal" Margin="0,2">
                                <TextBlock Text="å¯¾è±¡ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦:" Width="120" VerticalAlignment="Center" Foreground="Black"/>
                                <TextBox Text="{Binding WindowTitle, UpdateSourceTrigger=PropertyChanged}" Width="200" 
                                         Foreground="Black" Background="White"/>
                                <Button Content="å–å¾—" Command="{Binding GetWindowInfoCommand}" Margin="5,0,2,0" Width="40"
                                        Foreground="Black" Background="#F0F0F0"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,2">
                                <TextBlock Text="ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚¯ãƒ©ã‚¹:" Width="120" VerticalAlignment="Center" Foreground="Black"/>
                                <TextBox Text="{Binding WindowClassName, UpdateSourceTrigger=PropertyChanged}" Width="200"
                                         Foreground="Black" Background="White"/>
                                <Button Content="ã‚¯ãƒªã‚¢" Command="{Binding ClearWindowInfoCommand}" Margin="5,0,2,0" Width="40"
                                        Foreground="Black" Background="#F0F0F0"/>
                            </StackPanel>
                        </StackPanel>

                        <!-- Image Path Settings -->
                        <StackPanel Orientation="Horizontal" Margin="0,5" 
                                    Visibility="{Binding IsImageBasedItem, Converter={StaticResource BoolToVisibilityConverter}}">
                            <TextBlock Text="ç”»åƒãƒ‘ã‚¹:" Width="120" VerticalAlignment="Center" Foreground="Black"/>
                            <TextBox Text="{Binding ImagePath, UpdateSourceTrigger=PropertyChanged}" IsReadOnly="True" Width="150"
                                     Foreground="Black" Background="White"/>
                            <Button Content="å‚ç…§" Command="{Binding BrowseImageFileCommand}" Margin="5,0,2,0" Width="40"
                                    Foreground="Black" Background="#F0F0F0"/>
                            <Button Content="ã‚¯ãƒªã‚¢" Command="{Binding ClearImagePreviewCommand}" Margin="2,0,0,0" Width="40"
                                    Foreground="Black" Background="#F0F0F0"/>
                        </StackPanel>

                        <!-- Image Preview -->
                        <StackPanel Margin="0,5" 
                                    Visibility="{Binding HasImagePreview, Converter={StaticResource BoolToVisibilityConverter}}">
                            <TextBlock Text="ðŸ–¼ï¸ ç”»åƒãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼:" Foreground="Black" Margin="0,0,0,5" FontWeight="SemiBold"/>
                            <Border BorderBrush="DarkGray" BorderThickness="2" CornerRadius="3" MaxWidth="300" MaxHeight="200" Background="White">
                                <Border.Effect>
                                    <DropShadowEffect Color="Gray" Direction="315" ShadowDepth="2" Opacity="0.3"/>
                                </Border.Effect>
                                <Image Source="{Binding ImagePreview}" 
                                       Stretch="Uniform" 
                                       VerticalAlignment="Center" 
                                       HorizontalAlignment="Center"
                                       Margin="2"
                                       ToolTip="{Binding ImagePath}"/>
                            </Border>
                            <StackPanel Orientation="Horizontal" Margin="0,5,0,0" HorizontalAlignment="Center"
                                        Visibility="{Binding HasImageInfo, Converter={StaticResource BoolToVisibilityConverter}}">
                                <TextBlock Text="ðŸ“ " FontSize="12" Foreground="DarkGray"/>
                                <TextBlock Text="{Binding ImageInfo}" 
                                           FontSize="11" 
                                           Foreground="DarkGray" 
                                           FontWeight="SemiBold"
                                           VerticalAlignment="Center"/>
                            </StackPanel>
                            <TextBlock Text="{Binding ImagePath}" 
                                       FontSize="9" 
                                       Foreground="Gray" 
                                       TextWrapping="Wrap" 
                                       MaxWidth="300" 
                                       Margin="0,3,0,0"
                                       HorizontalAlignment="Center"
                                       TextAlignment="Center"
                                       ToolTip="{Binding ImagePath}"/>
                        </StackPanel>

                        <!-- Threshold Settings -->
                        <StackPanel Orientation="Horizontal" Margin="0,5"
                                    Visibility="{Binding IsImageBasedItem, Converter={StaticResource BoolToVisibilityConverter}}">
                            <TextBlock Text="ã—ãã„å€¤:" Width="120" VerticalAlignment="Center" Foreground="Black"/>
                            <Slider Value="{Binding Threshold, UpdateSourceTrigger=PropertyChanged}" 
                                    Minimum="0.01" Maximum="1.00" SmallChange="0.01" LargeChange="0.1" 
                                    TickFrequency="0.01" IsSnapToTickEnabled="True" Width="120"/>
                            <TextBox Text="{Binding Threshold, StringFormat=F2}" IsReadOnly="True" Width="50" Margin="5,0"
                                     Foreground="Black" Background="White"/>
                        </StackPanel>

                        <!-- AI Model Settings -->
                        <StackPanel Margin="0,5" Visibility="{Binding IsAIBasedItem, Converter={StaticResource BoolToVisibilityConverter}}">
                            <StackPanel Orientation="Horizontal" Margin="0,2">
                                <TextBlock Text="ONNXãƒ¢ãƒ‡ãƒ«:" Width="120" VerticalAlignment="Center" Foreground="Black"/>
                                <TextBox Text="{Binding ModelPath, UpdateSourceTrigger=PropertyChanged}" IsReadOnly="True" Width="150"
                                         Foreground="Black" Background="White"/>
                                <Button Content="å‚ç…§" Command="{Binding BrowseModelFileCommand}" Margin="5,0" Width="40"
                                        Foreground="Black" Background="#F0F0F0"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,2"
                                        Visibility="{Binding HasModelInfo, Converter={StaticResource BoolToVisibilityConverter}}">
                                <TextBlock Text="" Width="120"/>
                                <TextBlock Text="ðŸ” " FontSize="11" Foreground="DarkGray"/>
                                <TextBlock Text="{Binding ModelInfo}" 
                                           FontSize="11" 
                                           Foreground="DarkGray" 
                                           VerticalAlignment="Center"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,2">
                                <TextBlock Text="ã‚¯ãƒ©ã‚¹ID:" Width="120" VerticalAlignment="Center" Foreground="Black"/>
                                <TextBox Text="{Binding ClassID, UpdateSourceTrigger=PropertyChanged}" Width="100"
                                         Foreground="Black" Background="White"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,2">
                                <TextBlock Text="ä¿¡é ¼åº¦é–¾å€¤:" Width="120" VerticalAlignment="Center" Foreground="Black"/>
                                <Slider Value="{Binding ConfThreshold, UpdateSourceTrigger=PropertyChanged}" 
                                        Minimum="0.01" Maximum="1.00" SmallChange="0.01" LargeChange="0.1" 
                                        TickFrequency="0.01" IsSnapToTickEnabled="True" Width="100"/>
                                <TextBox Text="{Binding ConfThreshold, StringFormat=F2}" IsReadOnly="True" Width="50" Margin="5,0"
                                         Foreground="Black" Background="White"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,2">
                                <TextBlock Text="IoUé–¾å€¤:" Width="120" VerticalAlignment="Center" Foreground="Black"/>
                                <Slider Value="{Binding IoUThreshold, UpdateSourceTrigger=PropertyChanged}" 
                                        Minimum="0.01" Maximum="1.00" SmallChange="0.01" LargeChange="0.1" 
                                        TickFrequency="0.01" IsSnapToTickEnabled="True" Width="100"/>
                                <TextBox Text="{Binding IoUThreshold, StringFormat=F2}" IsReadOnly="True" Width="50" Margin="5,0"
                                         Foreground="Black" Background="White"/>
                            </StackPanel>
                        </StackPanel>

                        <!-- Click Settings -->
                        <StackPanel Margin="0,5" Visibility="{Binding IsClickItem, Converter={StaticResource BoolToVisibilityConverter}}">
                            <StackPanel Orientation="Horizontal" Margin="0,2">
                                <TextBlock Text="Xåº§æ¨™:" Width="120" VerticalAlignment="Center" Foreground="Black"/>
                                <TextBox Text="{Binding ClickX, UpdateSourceTrigger=PropertyChanged}" Width="80"
                                         Foreground="Black" Background="White"/>
                                <Button Content="å–å¾—" Command="{Binding GetMousePositionCommand}" Margin="5,0" Width="40"
                                        Foreground="Black" Background="#F0F0F0"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,2">
                                <TextBlock Text="Yåº§æ¨™:" Width="120" VerticalAlignment="Center" Foreground="Black"/>
                                <TextBox Text="{Binding ClickY, UpdateSourceTrigger=PropertyChanged}" Width="80"
                                         Foreground="Black" Background="White"/>
                            </StackPanel>
                        </StackPanel>

                        <!-- Mouse Button Settings -->
                        <StackPanel Orientation="Horizontal" Margin="0,5">
                            <TextBlock Text="ãƒœã‚¿ãƒ³:" Width="120" VerticalAlignment="Center" Foreground="Black"/>
                            <ComboBox ItemsSource="{Binding MouseButtons}" 
                                      SelectedItem="{Binding MouseButton}" Width="120"
                                      Foreground="Black" Background="White"/>
                            <StackPanel.Visibility>
                                <MultiBinding Converter="{StaticResource MultiBoolToVisibilityConverter}">
                                    <Binding Path="IsClickImageItem"/>
                                    <Binding Path="IsClickImageAIItem"/>
                                    <Binding Path="IsClickItem"/>
                                </MultiBinding>
                            </StackPanel.Visibility>
                        </StackPanel>

                        <!-- Background Click Settings -->
                        <StackPanel Margin="0,5">
                            <StackPanel Orientation="Horizontal" Margin="0,2">
                                <TextBlock Text="ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã‚¯ãƒªãƒƒã‚¯:" Width="120" VerticalAlignment="Center" Foreground="Black"/>
                                <CheckBox IsChecked="{Binding UseBackgroundClick, UpdateSourceTrigger=PropertyChanged}" 
                                          Foreground="Black"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,2">
                                <TextBlock Text="ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰æ–¹å¼:" Width="120" VerticalAlignment="Center" Foreground="Black"/>
                                <ComboBox ItemsSource="{Binding BackgroundClickMethods}" 
                                          SelectedValue="{Binding BackgroundClickMethod}" 
                                          SelectedValuePath="Value"
                                          DisplayMemberPath="DisplayName"
                                          Width="200" Margin="5,0"
                                          Foreground="Black" Background="White"
                                          IsEnabled="{Binding UseBackgroundClick}"/>
                            </StackPanel>
                            <StackPanel.Visibility>
                                <MultiBinding Converter="{StaticResource MultiBoolToVisibilityConverter}">
                                    <Binding Path="IsClickImageItem"/>
                                    <Binding Path="IsClickImageAIItem"/>
                                    <Binding Path="IsClickItem"/>
                                </MultiBinding>
                            </StackPanel.Visibility>
                        </StackPanel>

                        <!-- Hotkey Settings -->
                        <StackPanel Margin="0,5" Visibility="{Binding IsHotkeyItem, Converter={StaticResource BoolToVisibilityConverter}}">
                            <StackPanel Orientation="Horizontal" Margin="0,2">
                                <TextBlock Text="Ctrl:" Width="120" VerticalAlignment="Center" Foreground="Black"/>
                                <CheckBox IsChecked="{Binding CtrlKey, UpdateSourceTrigger=PropertyChanged}" Foreground="Black"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,2">
                                <TextBlock Text="Shift:" Width="120" VerticalAlignment="Center" Foreground="Black"/>
                                <CheckBox IsChecked="{Binding ShiftKey, UpdateSourceTrigger=PropertyChanged}" Foreground="Black"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,2">
                                <TextBlock Text="Alt:" Width="120" VerticalAlignment="Center" Foreground="Black"/>
                                <CheckBox IsChecked="{Binding AltKey, UpdateSourceTrigger=PropertyChanged}" Foreground="Black"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,2">
                                <TextBlock Text="ã‚­ãƒ¼:" Width="120" VerticalAlignment="Center" Foreground="Black"/>
                                <ComboBox ItemsSource="{Binding KeyList}" 
                                          SelectedItem="{Binding SelectedKey}" Width="120"
                                          Foreground="Black" Background="White"/>
                            </StackPanel>
                        </StackPanel>

                        <!-- Wait Settings -->
                        <StackPanel Margin="0,5" Visibility="{Binding IsWaitItem, Converter={StaticResource BoolToVisibilityConverter}}">
                            <StackPanel Orientation="Horizontal" Margin="0,2">
                                <TextBlock Text="å¾…æ©Ÿæ™‚é–“:" Width="120" Foreground="Black"/>
                                <TextBox Text="{Binding WaitHours, UpdateSourceTrigger=PropertyChanged}" 
                                         Width="30" VerticalAlignment="Center"
                                         Foreground="Black" Background="White"/>
                                <TextBlock Text="æ™‚é–“" Margin="5,0" VerticalAlignment="Center" Foreground="Black"/>
                                <TextBox Text="{Binding WaitMinutes, UpdateSourceTrigger=PropertyChanged}" 
                                         Width="30" VerticalAlignment="Center"
                                         Foreground="Black" Background="White"/>
                                <TextBlock Text="åˆ†" Margin="5,0" VerticalAlignment="Center" Foreground="Black"/>
                                <TextBox Text="{Binding WaitSeconds, UpdateSourceTrigger=PropertyChanged}" 
                                         Width="30" VerticalAlignment="Center"
                                         Foreground="Black" Background="White"/>
                                <TextBlock Text="ç§’" Margin="5,0" VerticalAlignment="Center" Foreground="Black"/>
                                <TextBox Text="{Binding WaitMilliseconds, UpdateSourceTrigger=PropertyChanged}" 
                                         Width="50" VerticalAlignment="Center"
                                         Foreground="Black" Background="White"/>
                                <TextBlock Text="ms" Margin="5,0" VerticalAlignment="Center" Foreground="Black"/>
                            </StackPanel>
                        </StackPanel>

                        <!-- Loop Settings -->
                        <StackPanel Orientation="Horizontal" Margin="0,5" 
                                    Visibility="{Binding IsLoopItem, Converter={StaticResource BoolToVisibilityConverter}}">
                            <TextBlock Text="ãƒ«ãƒ¼ãƒ—å›žæ•°:" Width="120" VerticalAlignment="Center" Foreground="Black"/>
                            <TextBox Text="{Binding LoopCount, UpdateSourceTrigger=PropertyChanged}" Width="100"
                                     Foreground="Black" Background="White"/>
                        </StackPanel>

                        <!-- Variable Settings -->
                        <StackPanel Margin="0,5" Visibility="{Binding IsVariableItem, Converter={StaticResource BoolToVisibilityConverter}}">
                            <StackPanel Orientation="Horizontal" Margin="0,2">
                                <TextBlock Text="å¤‰æ•°å:" Width="120" VerticalAlignment="Center" Foreground="Black"/>
                                <TextBox Text="{Binding VariableName, UpdateSourceTrigger=PropertyChanged}" Width="200"
                                         Foreground="Black" Background="White"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,2" 
                                        Visibility="{Binding IsSetVariableItem, Converter={StaticResource BoolToVisibilityConverter}}">
                                <TextBlock Text="å¤‰æ•°å€¤:" Width="120" VerticalAlignment="Center" Foreground="Black"/>
                                <TextBox Text="{Binding VariableValue, UpdateSourceTrigger=PropertyChanged}" Width="200"
                                         Foreground="Black" Background="White"/>
                            </StackPanel>
                            <StackPanel Visibility="{Binding IsIfVariableItem, Converter={StaticResource BoolToVisibilityConverter}}">
                                <StackPanel Orientation="Horizontal" Margin="0,2">
                                    <TextBlock Text="æ¼”ç®—å­:" Width="120" VerticalAlignment="Center" Foreground="Black"/>
                                    <ComboBox ItemsSource="{Binding Operators}" 
                                              SelectedValue="{Binding VariableOperator}" 
                                              SelectedValuePath="Key"
                                              DisplayMemberPath="DisplayName"
                                              Width="120" Foreground="Black" Background="White"/>
                                </StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,2">
                                    <TextBlock Text="æ¯”è¼ƒå€¤:" Width="120" VerticalAlignment="Center" Foreground="Black"/>
                                    <TextBox Text="{Binding VariableValue, UpdateSourceTrigger=PropertyChanged}" Width="200"
                                             Foreground="Black" Background="White"/>
                                </StackPanel>
                            </StackPanel>
                        </StackPanel>

                        <!-- Execute Program Settings -->
                        <StackPanel Margin="0,5" Visibility="{Binding IsExecuteItem, Converter={StaticResource BoolToVisibilityConverter}}">
                            <StackPanel Orientation="Horizontal" Margin="0,2">
                                <TextBlock Text="ãƒ—ãƒ­ã‚°ãƒ©ãƒ ãƒ‘ã‚¹:" Width="120" VerticalAlignment="Center" Foreground="Black"/>
                                <TextBox Text="{Binding ProgramPath, UpdateSourceTrigger=PropertyChanged}" IsReadOnly="True" Width="150"
                                         Foreground="Black" Background="White"/>
                                <Button Content="å‚ç…§" Command="{Binding BrowseProgramFileCommand}" Margin="5,0" Width="40"
                                        Foreground="Black" Background="#F0F0F0"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,2"
                                        Visibility="{Binding HasProgramInfo, Converter={StaticResource BoolToVisibilityConverter}}">
                                <TextBlock Text="" Width="120"/>
                                <TextBlock Text="ðŸ“‚ " FontSize="11" Foreground="DarkGray"/>
                                <TextBlock Text="{Binding ProgramInfo}" 
                                           FontSize="11" 
                                           Foreground="DarkGray" 
                                           VerticalAlignment="Center"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,2">
                                <TextBlock Text="å¼•æ•°:" Width="120" VerticalAlignment="Center" Foreground="Black"/>
                                <TextBox Text="{Binding Arguments, UpdateSourceTrigger=PropertyChanged}" Width="200"
                                         Foreground="Black" Background="White"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,2">
                                <TextBlock Text="ä½œæ¥­ãƒ•ã‚©ãƒ«ãƒ€:" Width="120" VerticalAlignment="Center" Foreground="Black"/>
                                <TextBox Text="{Binding WorkingDirectory, UpdateSourceTrigger=PropertyChanged}" IsReadOnly="True" Width="150"
                                         Foreground="Black" Background="White"/>
                                <Button Content="å‚ç…§" Command="{Binding BrowseWorkingDirectoryCommand}" Margin="5,0" Width="40"
                                        Foreground="Black" Background="#F0F0F0"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,2">
                                <TextBlock Text="çµ‚äº†ã¾ã§å¾…æ©Ÿ:" Width="120" VerticalAlignment="Center" Foreground="Black"/>
                                <CheckBox IsChecked="{Binding WaitForExit, UpdateSourceTrigger=PropertyChanged}" Foreground="Black"/>
                            </StackPanel>
                        </StackPanel>

                        <!-- Screenshot Settings -->
                        <StackPanel Margin="0,5" 
                                    Visibility="{Binding IsScreenshotItem, Converter={StaticResource BoolToVisibilityConverter}}">
                            <StackPanel Orientation="Horizontal" Margin="0,2">
                                <TextBlock Text="ä¿å­˜å…ˆãƒ•ã‚©ãƒ«ãƒ€:" Width="120" VerticalAlignment="Center" Foreground="Black"/>
                                <TextBox Text="{Binding SaveDirectory, UpdateSourceTrigger=PropertyChanged}" IsReadOnly="True" Width="150"
                                         Foreground="Black" Background="White"/>
                                <Button Content="å‚ç…§" Command="{Binding BrowseSaveDirectoryCommand}" Margin="5,0" Width="40"
                                        Foreground="Black" Background="#F0F0F0"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,2"
                                        Visibility="{Binding HasSaveDirectoryInfo, Converter={StaticResource BoolToVisibilityConverter}}">
                                <TextBlock Text="" Width="120"/>
                                <TextBlock Text="ðŸ’¾ " FontSize="11" Foreground="DarkGray"/>
                                <TextBlock Text="{Binding SaveDirectoryInfo}" 
                                           FontSize="11" 
                                           Foreground="DarkGray" 
                                           VerticalAlignment="Center"/>
                            </StackPanel>
                        </StackPanel>

                        <!-- Timeout and Interval Settings -->
                        <StackPanel Margin="0,5">
                            <StackPanel Orientation="Horizontal" Margin="0,2">
                                <TextBlock Text="ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ:" Width="120" VerticalAlignment="Center" Foreground="Black"/>
                                <TextBox Text="{Binding Timeout, UpdateSourceTrigger=PropertyChanged}" Width="80"
                                         Foreground="Black" Background="White"/>
                                <TextBlock Text="ms" Margin="5,0" VerticalAlignment="Center" Foreground="Black"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,2">
                                <TextBlock Text="å®Ÿè¡Œé–“éš”:" Width="120" VerticalAlignment="Center" Foreground="Black"/>
                                <TextBox Text="{Binding Interval, UpdateSourceTrigger=PropertyChanged}" Width="80"
                                         Foreground="Black" Background="White"/>
                                <TextBlock Text="ms" Margin="5,0" VerticalAlignment="Center" Foreground="Black"/>
                            </StackPanel>
                            <StackPanel.Visibility>
                                <MultiBinding Converter="{StaticResource MultiBoolToVisibilityConverter}">
                                    <Binding Path="IsWaitImageItem"/>
                                    <Binding Path="IsClickImageItem"/>
                                </MultiBinding>
                            </StackPanel.Visibility>
                        </StackPanel>

                        <!-- AI Detect Mode Settings -->
                        <StackPanel Orientation="Horizontal" Margin="0,5" 
                                    Visibility="{Binding IsSetVariableAIItem, Converter={StaticResource BoolToVisibilityConverter}}">
                            <TextBlock Text="AIæ¤œå‡ºãƒ¢ãƒ¼ãƒ‰:" Width="120" VerticalAlignment="Center" Foreground="Black"/>
                            <ComboBox ItemsSource="{Binding AiDetectModes}" 
                                      SelectedValue="{Binding AiDetectMode}" 
                                      SelectedValuePath="Key"
                                      DisplayMemberPath="DisplayName"
                                      Width="120" Foreground="Black" Background="White"/>
                        </StackPanel>

                        <!-- Comment Settings (for all commands) -->
                        <StackPanel Margin="0,10" Visibility="{Binding ShowAdvancedSettings, Converter={StaticResource BoolToVisibilityConverter}}">
                            <TextBlock Text="ã‚³ãƒ¡ãƒ³ãƒˆ:" Margin="0,0,0,5" Foreground="Black"/>
                            <TextBox Text="{Binding Comment, UpdateSourceTrigger=PropertyChanged}" 
                                     Height="60" TextWrapping="Wrap" AcceptsReturn="True"
                                     VerticalScrollBarVisibility="Auto"
                                     Foreground="Black" Background="White"/>
                        </StackPanel>
                    </StackPanel>
                </StackPanel>
            </ScrollViewer>
        </Border>
    </Grid>
</UserControl>