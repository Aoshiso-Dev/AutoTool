<UserControl x:Class="AutoTool.Desktop.Views.Parts.ButtonPanel"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="clr-namespace:AutoTool.Desktop.ViewModels"
             mc:Ignorable="d"
             d:DataContext="{d:DesignInstance Type=vm:ButtonPanelViewModel}">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- Main Button Bar -->
        <Border Grid.Row="0" Padding="8" Background="#FAFAFB" BorderBrush="#E5E7EB" BorderThickness="0,0,0,1">
            <DockPanel>
                <!-- Left group: file -->
                <StackPanel Orientation="Horizontal" DockPanel.Dock="Left" Margin="0,0,16,0">
                    <Button Content="新規作成" Command="{Binding NewCommand}" Margin="0,0,4,0"/>
                    <Button Content="読み込み" Command="{Binding LoadCommand}" Margin="0,0,4,0"/>
                    <Button Content="保存" Command="{Binding SaveCommand}"/>
                </StackPanel>

                <!-- Center group: edit -->
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                    <Button Content="選択を追加" Command="{Binding AddCommand}" 
                            Background="#10B981" Foreground="White" Margin="0,0,4,0"/>
                    <Button Content="削除" Command="{Binding RemoveCommand}" Margin="0,0,4,0"/>
                    <Button Content="↑" Command="{Binding MoveUpCommand}" Margin="0,0,4,0"/>
                    <Button Content="↓" Command="{Binding MoveDownCommand}"/>
                </StackPanel>

                <!-- Right group: run -->
                <StackPanel Orientation="Horizontal" DockPanel.Dock="Right">
                    <Button Content="実行" Background="#3B82F6" Foreground="White" 
                            Command="{Binding RunCommand}" Margin="0,0,4,0"/>
                    <Button Content="停止" Background="#EF4444" Foreground="White" 
                            Command="{Binding StopCommand}"/>
                </StackPanel>
            </DockPanel>
        </Border>
        
        <!-- Command Selection Panel -->
        <Border Grid.Row="1" Padding="8" Background="#F9FAFB" BorderBrush="#E5E7EB" BorderThickness="0,0,0,1">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="200"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="250"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                
                <TextBlock Grid.Column="0" Text="検索:" VerticalAlignment="Center" Margin="0,0,8,0"/>
                
                <TextBox Grid.Column="1" Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
                         VerticalAlignment="Center" Margin="0,0,16,0"/>
                
                <TextBlock Grid.Column="2" Text="コマンド:" VerticalAlignment="Center" Margin="0,0,8,0"/>
                
                <ComboBox Grid.Column="3" ItemsSource="{Binding FilteredCommands}"
                          SelectedItem="{Binding SelectedCommand}"
                          DisplayMemberPath="DisplayName"
                          VerticalAlignment="Center" Margin="0,0,16,0"/>
                
                <StackPanel Grid.Column="4" Orientation="Horizontal">
                    <!-- Quick Add Buttons for Common Commands -->
                    <Button Content="+ 待機" Command="{Binding AddSpecificCommandCommand}" 
                            CommandParameter="wait" Margin="0,0,4,0"/>
                    <Button Content="+ クリック" Command="{Binding AddSpecificCommandCommand}" 
                            CommandParameter="click" Margin="0,0,4,0"/>
                    <Button Content="+ 条件分岐" Command="{Binding AddSpecificCommandCommand}" 
                            CommandParameter="if" Margin="0,0,4,0"/>
                </StackPanel>
                
                <!-- Command Info -->
                <TextBlock Grid.Column="5" Text="{Binding SelectedCommand.Type, StringFormat='タイプ: {0}'}"
                           VerticalAlignment="Center" Foreground="#6B7280" 
                           HorizontalAlignment="Right"/>
            </Grid>
        </Border>
    </Grid>
</UserControl>